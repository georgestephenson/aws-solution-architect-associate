# Amazon S3 Notes

- Main building blocks of AWS
- Advertised as "infinitely scaling"

## Use Cases

- Backup, storage
- Disaster recovery
- Archive
- Hybrid cloud storage
- App hosting
- Media hosting
- Data lakes
- Static website

## Buckets

- Store objects in buckets (directories)
- Globally unique name
- Region specific, though looks global
- Naming convention is lowercase letters, numbers and hyphens

## Objects

- Objects have a key, the full path to object, which can look like directories, but it's just a key in a bucket
- Max size 5TB
- If uploading more than 5GB, must use multi-part upload

## Security

- User-based IAM policies restrict API calls to S3
- Bucket policies - resource-based bucket-wide policies, most common
- Object Access Control List (ACL) - fine grain
- Bucket Access Control List (ACL) - less common

### Bucket Policies

- JSON based policies
  - Resource: bucket/object
  - Effect: allow/deny
  - Actions: APIs to control
  - Principal: account/user

### Block Public Access

- Overriding settings to prevent company data leaks
- Will override even if you set public access with bucket policy

## Static Website Hosting

- Can set your bucket to be a static website with a website URL
- Must set bucket to be publicly accessible, in same way as a non-website bucket

## Versioning

- Version files, enabled at bucket level

## Replication

- Cross-Region Replication (CRR)
- Same-Region Replication (SRR)
- Can be replication for buckets across AWS accounts
- Must give IAM permissions
- CRR - Compliance, lower latency, across accounts
- SRR - live replication between prod and test
- When enabled, only new objects are replicated
- S3 Batch Replication - optionally replicate existing objects
- Can replicate delete markers optionally, but permanent deletions not replicated
- No chaining of replication

## Storage Classes

- General Purpose
  - 99.99% availability
  - Low latency
  - Sustain 2 concurrent facility failures 
  - Use cases: Big Data, gaming and apps, content distribution
- Infrequent Access
  - Lower cost, for data less frequently accessed
  - Standard-Infrequent Access
    - Use cases: Disaster Recovery, backups
  - One Zone-Infrequent Access
    - One AZ, secondary backups
- Glacier classes
  - Glacier Instant Retrieval
    - Millisecond retrieval
    - Minimum storage duration of 90 days
  - Glacier Flexible Retrieval
    - Different options, Bulk 5 to 12 hours is free
    - Minimum storage duration of 90 days
  - Glacier Deep Archive
    - Longer term
    - Minimum storage duration of 180 days
  - Intelligent-Tiering
    - Small monthly fee, objects move automatically between tiers based on usage
- S3 Express One Zone
  - High Performance, single Availability Zone
  - Compute and Storage in same AZ, optimise performance
  - Use cases: latency/data-sensitive apps, AI/ML training